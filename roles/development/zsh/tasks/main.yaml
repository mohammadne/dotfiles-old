---
- name: create destination path
  shell: |
    mkdir -p ~/.config

- name: symlink config files (server)
  shell: |
    ln -s "$SOURCE/files/zsh/zshrc.server" "$HOME/.zshrc"

- name: symlink config files (local)
  shell: |
    ln -s "$SOURCE/files/zsh/zshrc.local" "$HOME/.zshrc"
    ln -s "$SOURCE/files/zsh/p10k.zsh" "$HOME/.config/p10k.zsh"

- name: install plugins (local)
  shell: |
    local zsh_custom=${ZSH_CUSTOM:-$HOME/.config/oh-my-zsh/custom}
    git clone --depth=1 https://github.com/romkatv/powerlevel10k.git $zsh_custom/themes/powerlevel10k
    git clone https://github.com/zsh-users/zsh-autosuggestions "$zsh_custom/plugins/zsh-autosuggestions"
    git clone https://github.com/zsh-users/zsh-syntax-highlighting.git "$zsh_custom/plugins/zsh-syntax-highlighting"
    git clone https://github.com/zsh-users/zsh-history-substring-search "$zsh_custom/plugins/zsh-history-substring-search"
    git clone https://github.com/zsh-users/zsh-completions "$zsh_custom/plugins/zsh-completions"

- name: change default shell
  shell: |
    mkdir -p ~/.config
    sudo usermod --shell "$(which zsh)" "$(whoami)"
